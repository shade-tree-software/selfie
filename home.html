<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
<video autoplay>No Video</video>
<img src="">
<canvas style="display:none"></canvas>
<button id="stopButton" type="button">Stop</button>

<script>
    var errorCallback = function (e) {
        console.log('Reeeejected!', e);
    };
    navigator.getUserMedia = navigator.getUserMedia ||
            navigator.webkitGetUserMedia ||
            navigator.mozGetUserMedia ||
            navigator.msGetUserMedia;
    var video = document.querySelector('video');
    var stop = document.getElementById('stopButton');
    var canvas = document.querySelector('canvas');
    var ctx = canvas.getContext('2d');
    var localMediaStream = null;

    function snapshot() {
        if (localMediaStream) {
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            ctx.drawImage(video, 0, 0);
            // "image/webp" works in Chrome.
            // Other browsers will fall back to image/png.
            document.querySelector('img').src = canvas.toDataURL('image/webp');
        }
    }

    video.addEventListener('click', snapshot, false);

    stop.addEventListener('click', function(){
        video.src = null;
    }, false);

    var videoConfig = {
        video: true
    };

    if (navigator.getUserMedia) {
        navigator.getUserMedia(videoConfig, function (stream) {
            video.src = window.URL.createObjectURL(stream);
            localMediaStream = stream;
        }, errorCallback);
    }
</script>
</body>
</html>